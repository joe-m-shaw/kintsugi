---
title: "Ovarian Cancer Service Audit"
author: "Joe Shaw (CS20980)"
toc: true
date: today
date-format: "DD-MM-YYYY"
format:
  html:
    code-fold: true
    code-summary: "Show the code"
    embed-resources: true
editor: visual
vignette: >
  %\VignetteIndexEntry{audit}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{quarto::html}
---

# Find SeqOne csv files

```{r}

library(kintsugi)

connection <- connect_to_sql_server()

dna_db_pcr_new <- dplyr::tbl(connection, 
                             dbplyr::in_catalog(catalog = "MolecularDB",
                                                     schema = "dbo",
                                                     table = "PCR_New"))|> 
  janitor::clean_names()

all_worksheets <- dna_db_pcr_new |> 
  dplyr::select(pcrid, date, description) |> 
  dplyr::collect() |> 
  dplyr::mutate(ws = paste0("WS", pcrid))

seqone_ws_regex <- "seqone|seq\\sone|seq_one|SSXT\\ssWGS\\sHRD"

gi_ws_info <- all_worksheets |> 
  dplyr::filter(grepl(pattern = seqone_ws_regex,
               x = description,
               ignore.case = TRUE))

stopifnot(nrow(gi_ws_info) > 0)

head(gi_ws_info)

```